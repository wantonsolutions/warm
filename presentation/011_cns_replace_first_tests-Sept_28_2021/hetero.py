import numpy as np
import pandas as pd
import sys, os
import matplotlib.pyplot as plt
from scipy.stats import sem
plt.rcParams.update({'font.size': 14})

def mult (multi, arr):
    return [ a * multi for a in arr]

const_rand_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
const_rand_rate_tick = mult(3,const_rand_rate_tick)


const_select_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48]
const_select_rate_tick= mult(3,const_select_rate_tick)

const_select_50th=[ 160.836,160.296,160.027,159.739,159.738,159.685,160.301,160.803,161.441,162.306,163.06,164.492,165.892,167.749,169.642,171.7425,174.643,177.506,180.934,185.282,190.282,196.028,205.105,211.329,221.168,235.148,256.424,294.271,417.29,]
const_select_50th_sem=[ 0.05248999904743363,0.06300158728159158,0.03388598530366072,0.053686683637564195,0.07910221235844199,35.10960598839013,0.050557492026403625,0.044230532440837515,0.05309670422916996,0.12143697954082791,0.057644947740455456,0.06600560582253447,0.12505718691862402,0.08294793547762044,0.11614413459146303,0.09692749867813519,0.13829439612652236,0.11034427941674062,0.20070376179833052,0.15472349530694773,1.6788930996343956,0.13769132144038349,1.3107015526045553,0.4117059144583697,0.09700958715508264,0.37244739225829077,0.6328796884084635,0.48100960489371236,4.944115579150634,]
const_select_95th=[ 292.121,288.485,285.7437,283.351,282.563,281.699,282.0921999999997,283.4623999999999,285.668,287.751,290.819,294.452,298.66,304.98,311.582,320.73464999999993,333.473,348.988,365.883,386.273,407.3056999999997,428.651,468.1548999999999,481.7868499999996,517.725,578.795,701.111,902.862,1730.7322499999946,]
const_select_95th_sem=[ 0.08949335170837551,0.07052809014851398,0.07061623821757601,0.0924716178078524,0.16269640177336833,92.09094090981424,0.22470156118727969,0.18671594897065508,0.20958182173079376,0.24414842493859437,0.17316180843360754,0.2313600443032691,0.20707960401738823,0.24053223983490574,0.1760518105558674,0.2533172376685016,0.4651151614385611,0.385514260566355,0.5469638409895409,0.4933460695597057,4.808503751495913,0.42475633014706027,5.944412814685739,1.8946969905501998,0.6645487255274127,2.6954800081617916,6.1531659588054,5.2296902819288045,40.836938714327594,]
const_select_99th=[ 377.4296499999999,371.3331600000002,365.9396299999999,361.09283999999985,361.7845099999998,359.69179999999983,360.0540000000019,361.8031299999999,365.727,368.31,372.92527999999936,378.11184999999915,386.76,398.9126800000002,410.52894999999927,426.2,446.29454000000004,464.54398999999887,483.477,503.9641200000001,528.20208,552.2566499999995,608.6857400000002,630.935,698.9870000000005,817.5585699999998,1050.9037099999996,1416.3854000000003,3069.6014899999973,]
const_select_99th_sem=[ 0.18122865395415477,0.4493735135318965,0.1889481063941956,0.4673385379572367,0.44551106726330447,108.94143082834123,0.8138650800592764,0.6769198870028263,0.387222366327138,0.689051562703402,0.4929394246822644,0.9006047519528616,0.7243101615634733,0.7903647867193125,0.35462375074997077,0.6149057430012052,1.1656560962456441,0.5566719968292234,0.5844925836348126,0.8311937692525094,6.00134410883287,1.0962244166984325,9.781250517636638,4.983768114154661,3.188318787794961,8.928164440246707,17.574926513524826,18.438545889052374,79.98595356632455,]
const_select_99th9=[ 524.8971620000009,522.5730600000071,504.04994100000386,488.47750300000047,493.7055200000154,490.1726520000035,490.219564000003,486.608478000001,485.37610000002013,497.6511000000229,487.9446830000076,497.24183600000106,523.629316000002,540.585739000001,553.9617700000024,563.3100600000042,584.0940420000004,600.4368320000023,623.3441040000022,644.8981310000024,681.8667860000222,728.4055550000113,852.9634960000068,881.6713020000345,987.9293800000227,1201.5370320000052,1707.6123980000057,2300.758500000022,4978.618450000068,]
const_select_99th9_sem=[ 1.907215422370477,6.427478195164998,1.5042108269791947,5.3119337109932845,3.5941441129781,129.54716950584208,7.903610858478498,5.141962319694214,4.350792863432581,7.468760471972026,6.489434131502421,9.472762893026417,8.000485247254288,5.943781010212843,7.192573457132243,2.4653168938627257,7.275748438510309,3.3214504143531687,2.4956589103132534,2.7552097360942107,12.494593652709279,6.488555989045293,34.31242429823084,13.507574406762435,11.612602675624624,41.955399377673494,55.63218728907138,70.01845088305565,134.25461223888345,]



const_select_redirection_ratio=[ 0.003326896281991738,0.0044433937665926205,0.006413751626518766,0.008645619735920288,0.011653443190286208,0.11446237751973871,0.020557305369061838,0.027043650334769905,0.035413293316357654,0.046736674910097614,0.06024529228792703,0.07898795325128595,0.09944433969896496,0.12606527065150652,0.15748113118325194,0.19124578714125223,0.22982084426750052,0.26707978437926877,0.3051259610102331,0.33965258188087655,0.3771655292214639,0.40119273809707706,0.4321777216977566,0.45323008569206935,0.47102966770673504,0.48319238012162186,0.4808619101780601,0.4572128119672571,0.37980369145763443,]
const_select_gossip_ratio=[ 0.00011322247382771962,0.00015291031180581893,0.00022343483995621,0.0003071503223049395,0.0004236117386840573,0.006447835977605641,0.0008266682917410863,0.0011386843459174072,0.0016238113280443328,0.002294638301172254,0.0031533389392692252,0.0045490361712139105,0.006160561972807611,0.008563444723367342,0.011752695869713285,0.015572132916368095,0.020329773165208065,0.025620997892129092,0.03135776697672172,0.03667366629597292,0.04188469458979639,0.04439401983253645,0.04548328286325428,0.04558619227656129,0.043423882246345705,0.03921894844153442,0.033201922552953685,0.024437947352753498,0.012439087319398535,]
const_select_pct50th_queue_depth=[ 160.836,160.296,160.027,159.739,159.738,159.685,160.301,160.803,161.441,162.306,163.06,164.492,165.892,167.749,169.642,171.7425,174.643,177.506,180.934,185.282,190.282,196.028,205.105,211.329,221.168,235.148,256.424,294.271,417.29,]
const_select_pct95th_queue_depth=[ 292.121,288.485,285.7437,283.351,282.563,281.699,282.0921999999997,283.4623999999999,285.668,287.751,290.819,294.452,298.66,304.98,311.582,320.73464999999993,333.473,348.988,365.883,386.273,407.3056999999997,428.651,468.1548999999999,481.7868499999996,517.725,578.795,701.111,902.862,1730.7322499999946,]
const_select_pct99th_queue_depth=[ 377.4296499999999,371.3331600000002,365.9396299999999,361.09283999999985,361.7845099999998,359.69179999999983,360.0540000000019,361.8031299999999,365.727,368.31,372.92527999999936,378.11184999999915,386.76,398.9126800000002,410.52894999999927,426.2,446.29454000000004,464.54398999999887,483.477,503.9641200000001,528.20208,552.2566499999995,608.6857400000002,630.935,698.9870000000005,817.5585699999998,1050.9037099999996,1416.3854000000003,3069.6014899999973,]
const_select_pct99th9_queue_depth=[ 524.8971620000009,522.5730600000071,504.04994100000386,488.47750300000047,493.7055200000154,490.1726520000035,490.219564000003,486.608478000001,485.37610000002013,497.6511000000229,487.9446830000076,497.24183600000106,523.629316000002,540.585739000001,553.9617700000024,563.3100600000042,584.0940420000004,600.4368320000023,623.3441040000022,644.8981310000024,681.8667860000222,728.4055550000113,852.9634960000068,881.6713020000345,987.9293800000227,1201.5370320000052,1707.6123980000057,2300.758500000022,4978.618450000068,]

const_rand_50th=[ 161.171,160.8755,160.622,160.508,160.464,160.763,161.567,162.497,163.846,165.463,167.329,170.906,175.205,181.559,191.447,210.993,292.52,]
const_rand_50th_sem=[ 0.058608019929016805,0.11404122061781065,0.045637046354907757,0.06377193740196194,0.055212860820646914,0.03709393481419963,0.06732265591909038,0.042969058635251856,0.09036503748685355,0.08003536718226434,0.09111234823008421,0.08731872651384648,0.16173385545395197,0.10453784003890461,0.14489927536050753,0.3573173099641243,1.5546389484378669,]
const_rand_95th_sem=[ 0.11214967855504254,0.26994649312410296,0.051709248689196775,0.16840429210681457,0.0960400624739388,0.11791204624633501,0.12350309955615842,0.3963448518651105,0.36326376002843586,0.5806311288158255,0.7126631515659809,1.4193868572908364,0.8229230631717965,1.72576950097628,2.8655265396346934,5.022097684682951,27.916452282388306,]
const_rand_99th=[ 381.9603599999994,379.5215399999998,378.1930499999998,380.1038599999999,386.4020499999989,394.87814999999944,410.2810600000001,430.3950499999998,461.6895299999998,500.25896,555.757799999999,634.0424500000003,750.3467099999995,942.7610000000009,1276.408129999999,2026.5942200000006,4491.037600000009,]
const_rand_99th_sem=[ 0.3727020821568008,0.6993698555813276,0.24899938244905717,0.6807084263617982,0.4711187388505148,0.6886828160698708,0.7062963205653516,1.6056904715904274,0.8819424819626106,2.1657642109244235,2.8552335240198317,5.3867243263036535,3.764593680848498,7.527062123338574,11.092010180463449,14.485304877628883,54.561654256138965,]
const_rand_99th9=[ 529.5715180000238,533.8544360000002,541.2123000000033,524.0725540000068,563.3338440000094,570.4908040000089,582.3464200000167,627.715,682.1466160000153,744.582718000011,855.5972320000083,994.1971250000181,1188.858285000002,1583.4312640000824,2177.01809600012,3347.563249000014,6889.330471,]
const_rand_99th9_sem=[ 6.220541218821034,6.14904852871023,2.8771207613685053,18.363018489491605,11.287145467445328,7.926059687530034,8.54329170839735,37.013637966529714,5.245046764535847,27.5009423448941,27.853020574912396,126.51903597840469,27.94991390917967,52.38770785281664,74.76016977493464,86.65992880994321,202.79182982919235,]
print(len(const_rand_rate_tick))
print(len(const_select_rate_tick))

print(len(const_rand_99th))
print(len(const_select_99th))


#fig, ax = plt.subplots(figsize=(8, 5))
fig, (ax1, ax2, ax3) = plt.subplots(1,3, figsize=(20,5))



#ax1.errorbar(rate_tick, rand_50th, yerr=rand_50th_sem, color="tab:red",linestyle='solid',
#    label="random 50th pct", marker='.', lw=1.5)
#ax1.errorbar(rate_tick, rand_95th, yerr=rand_95th_sem, color="tab:red",linestyle='dashed',
#    label="random 95th pct", marker='.', lw=1.5)
ax1.errorbar(const_rand_rate_tick, const_rand_99th, yerr=const_rand_99th_sem, color="tab:red",linestyle='solid',
    label="Random", marker='s', lw=1.5)
#ax1.errorbar(rate_tick, rand_99th9, yerr=rand_99th9_sem, color="tab:red",linestyle='dotted',
#    label="random 99th9 pct", marker='.', lw=1.5)

#ax1.errorbar(rate_tick, select_50th, yerr=select_50th_sem, color="tab:blue",linestyle='solid',
#    label="replica select 50th pct", marker='.', lw=1.5)
#ax1.errorbar(rate_tick, select_95th, yerr=select_95th_sem, color="tab:blue",linestyle='dashed',
#    label="replica select 95th pct", marker='.', lw=1.5)
ax1.errorbar(const_select_rate_tick, const_select_99th, yerr=const_select_99th_sem, color="tab:blue",linestyle='solid',
    label="Daronpon", marker='o', lw=1.5)
#ax1.errorbar(rate_tick, select_99th9, yerr=select_99th9_sem, color="tab:blue",linestyle='dotted',
#    label="replica select 99th9 pct", marker='.', lw=1.5)


ax1.grid(True)
ax1.legend(loc='upper left', prop={'size': 12})
fig_xlabel  = "Load (KRPS)"
fig_ylabel  = "99th% Latency (us)"
ax1.set_xlabel(fig_xlabel)
ax1.set_ylabel(fig_ylabel)
ax1.set_ylim(bottom=0, top=4750)
ax1.set_title("Constant")
#ax1.text(20,1000, 'HOMO COPY TODO', fontsize=36, color='red')





bi_rand_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
bi_select_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48]


bi_rand_rate_tick = mult(3,bi_rand_rate_tick)
bi_select_rate_tick= mult(3,bi_select_rate_tick)


bi_select_50th=[ 165.447,164.817,164.451,164.34,164.58,165.24,165.945,166.726,167.763,169.209,171.585,174.245,177.089,180.348,184.214,189.589,195.207,202.243,210.307,218.033,226.376,236.079,246.847,259.446,277.992,303.247,341.507,410.933,532.715,]
bi_select_50th_sem=[ 3.425583445195869,0.16710151106438087,0.12250020408146162,0.04100073170078877,0.04169772176030792,0.14081498499804546,0.16095213574227785,0.14777022704184986,0.11089066687508009,0.1658042219004064,0.3757336290512188,0.1715614758621524,0.12753093742304328,0.15798658170870367,0.0840573613671023,0.07518816396215576,0.203969507525024,0.15965694472838046,0.2683532932535049,0.3953611007673853,1.323384124130255,0.30767757474342994,0.2195678482838514,0.16699269445098944,5.942743504476705,1.6688316392015092,8.69297505805693,45.73110875498209,20.101129850085545,]
bi_select_95th=[ 360.307,360.654,360.844,362.482,364.8250999999996,367.565,372.0121499999999,376.6935500000003,382.12975,389.121,398.098,409.665,421.671,436.412,453.1715500000003,471.21119999999974,491.45789999999994,512.621,537.6,564.3587999999999,596.425,634.7487000000002,685.127,745.451,845.107,974.534,1171.2939999999985,1540.018,2246.814,]
bi_select_95th_sem=[ 9.462021376632485,0.14691457075455422,0.22369267846758206,0.13967899036718961,0.17884870561459482,0.24920700150680278,0.2516151767084162,0.20327796695658834,0.26616713715256923,0.3361180447402405,0.49000269019668224,0.6047909383828745,0.41151959388343307,0.21489167131377118,0.24524594206633393,0.0702242960092866,0.4910870413175012,0.41231368750027325,0.6919871252415126,1.043581146389419,5.259060153354444,0.9808313006067272,0.7366085477375203,1.6167517708664847,21.103210183192516,8.47996524815975,27.07732540718792,197.89545249929097,73.67360687076233,]
bi_select_99th=[ 483.77975,487.36241999999993,488.73166000000015,492.1420499999996,496.19401999999957,503.12045999999947,511.671,521.015,531.7174499999998,544.8183599999994,564.2454300000002,582.44356,603.8223799999998,626.682,649.9622799999994,671.6821799999988,698.4665299999998,728.1176200000001,764.4571799999997,803.1313600000003,858.90192,921.5087099999995,1010.2490499999993,1109.486,1288.2126000000005,1527.9162200000007,1854.3355600000004,2450.5488000000023,3676.8307299999988,]
bi_select_99th_sem=[ 18.851672273252742,0.36588144769845155,0.7684566728747758,0.8717572725053545,0.5419470722552059,0.7867202133887241,0.6120931132302415,0.5286632406459038,1.0895643508376487,1.1954479622109553,1.1168353762780314,2.0350628838950486,1.3434045545632256,0.8268707039495112,0.6124615817472205,0.4687966833457655,0.7652088458678045,0.5418636041700405,0.985605392692281,2.6876009542435497,7.468268150342834,1.9966958875869434,2.695427528874655,5.663519788368032,35.750490320342536,10.30035558601986,38.676275326549394,158.93099413203782,98.70301617144219,]
bi_select_99th9=[ 675.5346070000098,695.4329270000185,694.9542640000024,697.020908000011,706.6971960000117,732.4219480000156,735.0299080000203,753.2522720000395,754.2115400000047,778.9155400000159,806.1454460000191,832.8419120000004,858.6993220000006,887.9860000000075,897.6585650000181,933.1235130000044,972.7532900000028,1024.680264000006,1082.779818000027,1159.9801620000312,1257.325504000034,1355.1903710000013,1501.288610000006,1671.2279220000012,2018.712440000006,2346.1587800000398,2930.108619000027,3738.2903710000014,5651.255672000024,]
bi_select_99th9_sem=[ 43.154829859262115,3.9459297168797014,6.880429487165794,9.282547527032703,6.595675318982695,8.373178960331776,6.294400980039551,9.229969820481289,9.623264811278048,6.700014974419922,15.613837288901932,16.13544499413388,7.325229074562161,6.274049372446774,4.087659166114958,1.7451509235631129,1.8495524869040678,4.138800097187922,5.006751050579661,8.523451507993284,13.77940213343599,9.93460399516774,9.328780595398147,18.38071149783758,67.60986112089562,55.44146455689821,40.873336574291926,127.13773532590139,87.80193713296215,]

bi_select_redirection_ratio=[ 0.09112623287815069,0.038372042943164215,0.04966876714144185,0.0633922120414169,0.07944459156405845,0.09896156296755622,0.1227405202212687,0.1478258522092919,0.17668602726557936,0.207576534426076,0.23867207832780235,0.2764022525043756,0.31227104580024967,0.3463291920726934,0.37960672351469354,0.41004621398879354,0.4382022229157757,0.4624564759289229,0.4840245672873791,0.5037561300646645,0.5195946285285586,0.5352252750303019,0.5472331427211488,0.5555500200930399,0.5553002241316074,0.5544535787776113,0.539912138083605,0.45005557688733405,0.44523479486071815,]
bi_select_gossip_ratio=[ 0.005076457417613401,0.001749527697363137,0.002465559540298247,0.003381842937250688,0.004674267915310954,0.006302320074410773,0.008521379902859687,0.011016809164855347,0.014292710890461888,0.017850989315919868,0.022477806083163215,0.027299457834503608,0.03267273782955499,0.03810764278783544,0.04368909385074772,0.04911316468521605,0.053920732267389894,0.057784506914181646,0.06070541038802688,0.06247107546231682,0.06256994450661733,0.06623095143367351,0.059813340553093675,0.05615126090026741,0.05110067316250011,0.04330425526987122,0.03604718284524029,0.02053803457677192,0.014236724167792168,]
bi_select_pct50th_queue_depth=[ 165.447,164.817,164.451,164.34,164.58,165.24,165.945,166.726,167.763,169.209,171.585,174.245,177.089,180.348,184.214,189.589,195.207,202.243,210.307,218.033,226.376,236.079,246.847,259.446,277.992,303.247,341.507,410.933,532.715,]
bi_select_pct95th_queue_depth=[ 360.307,360.654,360.844,362.482,364.8250999999996,367.565,372.0121499999999,376.6935500000003,382.12975,389.121,398.098,409.665,421.671,436.412,453.1715500000003,471.21119999999974,491.45789999999994,512.621,537.6,564.3587999999999,596.425,634.7487000000002,685.127,745.451,845.107,974.534,1171.2939999999985,1540.018,2246.814,]
bi_select_pct99th_queue_depth=[ 483.77975,487.36241999999993,488.73166000000015,492.1420499999996,496.19401999999957,503.12045999999947,511.671,521.015,531.7174499999998,544.8183599999994,564.2454300000002,582.44356,603.8223799999998,626.682,649.9622799999994,671.6821799999988,698.4665299999998,728.1176200000001,764.4571799999997,803.1313600000003,858.90192,921.5087099999995,1010.2490499999993,1109.486,1288.2126000000005,1527.9162200000007,1854.3355600000004,2450.5488000000023,3676.8307299999988,]
bi_select_pct99th9_queue_depth=[ 675.5346070000098,695.4329270000185,694.9542640000024,697.020908000011,706.6971960000117,732.4219480000156,735.0299080000203,753.2522720000395,754.2115400000047,778.9155400000159,806.1454460000191,832.8419120000004,858.6993220000006,887.9860000000075,897.6585650000181,933.1235130000044,972.7532900000028,1024.680264000006,1082.779818000027,1159.9801620000312,1257.325504000034,1355.1903710000013,1501.288610000006,1671.2279220000012,2018.712440000006,2346.1587800000398,2930.108619000027,3738.2903710000014,5651.255672000024,]

bi_rand_50th=[ 168.041,167.714,168.159,168.963,170.377,172.315,174.875,177.942,181.423,186.759,193.593,202.105,213.616,225.733,241.924,269.739,343.941,]
bi_rand_50th_sem=[ 0.16493786708939903,0.10059343914987837,0.08144691522703552,0.11194936355334931,0.10136893015120549,0.18069903154139985,0.14869586409850075,0.09503315211019901,0.077132613076444,0.18185351247638998,0.05769532043415931,0.14113082583191955,0.1653192668747338,0.14271706275004384,0.3296532420589854,0.3817584838612008,2.1940867439552156,]
bi_rand_95th=[ 380.5758499999999,386.9003999999999,396.1523999999999,407.8444999999996,424.62669999999997,444.518,467.56219999999973,500.34079999999983,539.0599499999996,590.39675,663.1304000000003,749.1506999999997,871.6310499999994,1067.4921999999997,1377.9542999999996,1945.6691999999998,3473.303,]
bi_rand_95th_sem=[ 0.4862541016279057,0.24086842341819673,0.1794126064411406,0.3275466128660328,0.43399491460154777,0.4280552271611705,0.17995118115763728,0.7363488031497237,0.9520041178220328,1.269135524382732,2.26243288633055,1.169761688486054,1.823381948646368,2.8409990737414277,3.550357539058232,11.483753272445675,69.8852501864101,]
bi_rand_99th=[ 542.7588500000003,561.0611999999995,586.9056600000006,615.8295199999995,655.0346799999996,704.3306000000006,751.63542,818.6723200000004,901.8708799999971,1002.7407999999971,1135.3359200000004,1300.1496400000005,1525.3086400000082,1917.7525899999998,2481.6952499999998,3509.6283199999984,5974.487,]
bi_rand_99th_sem=[ 1.682724762447336,0.859468664569004,1.172509813683388,1.3200277005518837,1.808306204201409,2.243463398213799,1.2693917823811478,3.6400229187267086,3.110922469187471,4.943798192322763,8.867744374481598,3.9749523341557933,3.1051119047140734,8.12398706236644,20.649155584961672,14.461794547137652,101.64771994042371,]
bi_rand_99th9=[ 833.6180480000125,890.2289520000019,926.7955520000419,1001.2614340000646,1065.5812300001555,1170.8892680000067,1241.2722120000394,1362.2641140001006,1550.6376040000357,1765.750300000077,1939.8797360000312,2230.426246000077,2565.4635720000197,3262.201022000006,4130.53545500028,5648.908266000004,8963.310892000209,]
bi_rand_99th9_sem=[ 22.548500922699898,9.684629548128173,10.722957719731298,11.357162052442371,10.911789022004918,15.979136967365928,29.8845333261852,37.28317346877725,24.197316020128763,32.29052250745305,68.93155385683573,15.887824693190314,99.98508365603558,51.09957195947008,101.81954043682133,23.471579378536003,108.45295502488318,]




#ax3.errorbar(bi_rate_tick, bi_rand_50th, yerr=bi_rand_50th_sem, color="tab:red",linestyle='solid',
#    label="random 50th pct", marker='.', lw=1.5)
#ax3.errorbar(bi_rate_tick, bi_rand_95th, yerr=bi_rand_95th_sem, color="tab:red",linestyle='dashed',
#    label="random 95th pct", marker='.', lw=1.5)
ax2.errorbar(bi_rand_rate_tick, bi_rand_99th, yerr=bi_rand_99th_sem, color="tab:red",linestyle='solid',
    label="Random", marker='s', lw=1.5)
#ax3.errorbar(bi_rate_tick, bi_rand_99th9, yerr=bi_rand_99th9_sem, color="tab:red",linestyle='dotted',
#    label="random 99th9 pct", marker='.', lw=1.5)

#ax3.errorbar(bi_rate_tick, bi_select_50th, yerr=bi_select_50th_sem, color="tab:blue",linestyle='solid',
#    label="replica select 50th pct", marker='.', lw=1.5)
#ax3.errorbar(bi_rate_tick, bi_select_95th, yerr=bi_select_95th_sem, color="tab:blue",linestyle='dashed',
#    label="replica select 95th pct", marker='.', lw=1.5)
ax2.errorbar(bi_select_rate_tick, bi_select_99th, yerr=bi_select_99th_sem, color="tab:blue",linestyle='solid',
    label="Daronpon", marker='o', lw=1.5)
#ax3.errorbar(bi_rate_tick, bi_select_99th9, yerr=bi_select_99th9_sem, color="tab:blue",linestyle='dotted',
#    label="replica select 99th9 pct", marker='.', lw=1.5)

ax2.grid(True)
ax2.legend(loc='upper left', prop={'size': 12})
ax2.set_xlabel(fig_xlabel)
ax2.set_ylabel(fig_ylabel)
ax2.set_ylim(bottom=0, top=7000)
ax2.set_title("Bimodal")

exp_rand_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]
exp_select_rate_tick =[ 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48]

exp_rand_rate_tick = mult(3,exp_rand_rate_tick)
exp_select_rate_tick= mult(3,exp_select_rate_tick)

exp_select_50th=[ 170.268,169.872,169.734,169.701,170.065,170.45,170.943,171.921,172.988,174.257,176.519,177.715,180.028,182.72,186.228,190.392,194.309,199.035,205.307,212.272,219.736,229.356,241.311,257.67,278.765,309.832,369.265,519.279,2345.623,]
exp_select_50th_sem=[ 0.20242875289839632,0.05185595433506037,0.07548238205038041,0.1395017562613443,0.04435425571463962,0.03626348025218054,0.11073274131890487,0.07184295372546483,0.0896451894972637,0.05437867228978861,0.12479999999999902,0.1422293570258964,0.6185787742882897,0.1338691898832561,0.30034956300950644,0.15787507719712743,0.20931521683814816,0.12100107437539474,0.0642650760522416,0.09513758458148465,0.23440550334836152,0.09017239045295429,0.24950563119897526,0.3643419547622822,0.5287049649851958,1.0990026387593448,1.9621626996760515,2.923310915725522,65.3720962235418,]
exp_select_95th=[ 331.47249999999997,329.324,329.052,329.25319999999994,330.8200999999996,332.244,333.9988500000001,337.8883999999999,341.976,348.582,355.7645499999998,363.286,373.053,386.644,403.448,422.81694999999974,440.878,461.65969999999976,486.4289499999997,512.4250499999998,540.064,577.0076999999998,628.3908999999999,702.8550999999997,805.279,953.1839499999996,1299.1698999999999,2148.42325,9949.139749999998,]
exp_select_95th_sem=[ 0.42959718341720454,0.20239599798415325,0.06750099443710836,0.23114824810064502,0.21900848522375152,0.20291670064337233,0.28013382221719,0.23534745717761796,0.3680276370056938,0.11365632406513913,0.026449999999999817,0.5288430201865257,3.6504621686301246,0.4721148678023125,0.9291558757280508,0.4718677401031667,0.6673272582474244,0.3748286716621963,0.5477829083222506,0.3553042455417183,1.0342655546328505,0.798776087899514,1.8363647956356048,2.9286010779294758,6.511204014435431,11.736404802191332,18.385440995411304,26.076807181586464,69.96786894416358,]
exp_select_99th=[ 438.93100000000004,436.05660999999964,437.1127799999998,438.79871999999995,442.4574700000002,443.95793000000015,446.29139000000015,454.22983999999985,462.49704,473.4901200000001,487.5218200000003,502.9865499999998,520.9991200000002,540.97258,563.6362400000003,588.3795600000001,610.05858,635.3707499999991,668.1465899999998,703.31,744.7300999999997,809.9940999999997,900.4747400000002,1039.0249699999997,1210.625,1439.2067699999996,2075.5574800000004,3540.976849999999,11497.747480000004,]
exp_select_99th_sem=[ 0.9361200991401131,0.5097539985660844,0.22624192479734026,0.5193785184487016,0.4642211263180579,0.5179360889492204,0.8100015467677646,0.8214990973799386,1.0267834964312512,0.09856256827008013,0.6218439999997712,1.6487332860489425,5.911270870373323,0.7314557512726394,1.0065375529822864,1.3868472945007364,2.547121641230282,1.4008286395865026,1.4796335951531592,0.6078788841817955,2.1605519070450163,1.8515544383183078,5.244091042032285,7.971174012877097,18.963850038579782,29.832692424411654,43.06582433985576,50.24360338287461,28.98286638113424,]
exp_select_99th9=[ 619.0801740000006,605.774446000006,613.2980230000007,603.3261750000054,626.8155640000003,617.2543100000033,617.0308580000075,634.0219360000342,634.0843000000012,663.0623840000034,682.3192080000341,699.953200000003,727.1691500000046,738.5070380000011,768.9821920000016,795.2278560000062,825.0512280000308,855.6127300000032,919.1446720000021,981.1906320000105,1047.3790150000177,1168.3697400000083,1304.3368320000022,1568.2813830000268,1925.7573720000757,2141.978212000018,3279.9339180000006,5811.1649250000355,12683.227448000014,]
exp_select_99th9_sem=[ 3.2554331208653933,1.8048010280416655,3.83736804556661,3.4610718489459367,7.7914859410664485,7.89309058944151,7.624355409234187,6.409825842924955,7.433852867179193,1.3794634617095345,9.304279999993742,17.84231469286584,15.306290454195159,4.147186677536135,0.6550517849307987,14.47266626619716,52.67759232234808,3.660718245915316,14.401894558236734,4.958903775542393,7.959743349400275,16.57669519181973,15.828253926531046,22.545956390996675,57.827860952052376,95.393565501357,82.94958585405213,134.95875995701988,19.59547278664161,]

exp_select_redirection_ratio=[ 0.015071814619991294,0.01882204842528255,0.025602170347599658,0.03358779437254951,0.04323276524586157,0.05564621742095077,0.07093489545539472,0.09042176472326317,0.11428658276761167,0.13993280452046497,0.17299543147302124,0.20496512433025904,0.2454063130643237,0.2807641302706044,0.32132943729261815,0.358976577942973,0.39249988055542284,0.4220791696904435,0.4491341654008266,0.47299239703010554,0.4945052722830501,0.5132895508202067,0.525504796990726,0.5348088347552895,0.533951165513627,0.5230957569083419,0.4893904481738846,0.4166867730639052,0.22758196359858585,]
exp_select_gossip_ratio=[ 0.0005757791852380083,0.000722541135267891,0.001066365682924038,0.0015076357635473692,0.0020672260504186117,0.0028634709936895017,0.0039989805112520685,0.005578037086995996,0.007772550169313721,0.010081237641269319,0.013688395719251331,0.01758704652184881,0.02319475443715894,0.02768158423906401,0.03398011644069792,0.04000169397008238,0.04572838414264905,0.050358670035879315,0.05422908513024142,0.0565693393224746,0.057859280081502304,0.05704118767799474,0.05421293172149337,0.04996344441988514,0.043734987045190896,0.035757328095466785,0.025364904959565417,0.01340856742924404,0.00021555570524701753,]

exp_select_pct50th_queue_depth=[ 170.268,169.872,169.734,169.701,170.065,170.45,170.943,171.921,172.988,174.257,176.519,177.715,180.028,182.72,186.228,190.392,194.309,199.035,205.307,212.272,219.736,229.356,241.311,257.67,278.765,309.832,369.265,519.279,2345.623,]
exp_select_pct95th_queue_depth=[ 331.47249999999997,329.324,329.052,329.25319999999994,330.8200999999996,332.244,333.9988500000001,337.8883999999999,341.976,348.582,355.7645499999998,363.286,373.053,386.644,403.448,422.81694999999974,440.878,461.65969999999976,486.4289499999997,512.4250499999998,540.064,577.0076999999998,628.3908999999999,702.8550999999997,805.279,953.1839499999996,1299.1698999999999,2148.42325,9949.139749999998,]
exp_select_pct99th_queue_depth=[ 438.93100000000004,436.05660999999964,437.1127799999998,438.79871999999995,442.4574700000002,443.95793000000015,446.29139000000015,454.22983999999985,462.49704,473.4901200000001,487.5218200000003,502.9865499999998,520.9991200000002,540.97258,563.6362400000003,588.3795600000001,610.05858,635.3707499999991,668.1465899999998,703.31,744.7300999999997,809.9940999999997,900.4747400000002,1039.0249699999997,1210.625,1439.2067699999996,2075.5574800000004,3540.976849999999,11497.747480000004,]
exp_select_pct99th9_queue_depth=[ 619.0801740000006,605.774446000006,613.2980230000007,603.3261750000054,626.8155640000003,617.2543100000033,617.0308580000075,634.0219360000342,634.0843000000012,663.0623840000034,682.3192080000341,699.953200000003,727.1691500000046,738.5070380000011,768.9821920000016,795.2278560000062,825.0512280000308,855.6127300000032,919.1446720000021,981.1906320000105,1047.3790150000177,1168.3697400000083,1304.3368320000022,1568.2813830000268,1925.7573720000757,2141.978212000018,3279.9339180000006,5811.1649250000355,12683.227448000014,]



exp_rand_50th=[ 171.408,171.181,171.296,171.996,172.797,173.92,175.569,177.471,179.905,183.5445,188.537,194.531,202.55,216.45,238.801,297.205,821.861,]
exp_rand_50th_sem=[ 0.10098534547150965,0.1010569146570348,0.1270555390370719,0.12503015636237536,0.116350590888055,0.060795065589241484,0.0675524981033246,0.09083341896020707,0.21015008922196432,0.05867013720795138,0.09716347050203808,0.5751381225410149,0.23887180662438795,0.1281190852293288,0.2788314186027089,0.5938076793036666,19.463356045785122,]
exp_rand_95th=[ 341.484,343.358,348.854,355.647,367.46779999999984,381.48885000000007,400.821,426.36385000000007,460.093,506.15250000000003,567.848,656.6918500000002,794.1835999999977,1019.41,1454.0958500000002,2629.269,7605.632999999996,]
exp_rand_95th_sem=[ 0.11909754552474117,0.3603429399197528,0.2334451335967453,0.29625944710676066,0.3504758737772888,0.15728769786608657,0.18220381005897243,0.7986895001188388,1.1058894791072034,0.6968720607113048,1.3521802035416572,2.977082926146021,2.5586685931552573,4.588190926950378,3.2577276471262766,6.912763468150905,81.06998878736295,]
exp_rand_99th=[ 465.82795000000067,478.0789999999986,492.7502000000004,509.32869999999997,537.41758,572.672,611.1279799999977,666.5886300000003,730.6779200000018,822.3826099999999,938.1242000000002,1111.4023999999974,1356.8736799999997,1786.32616,2573.5532799999887,4807.940199999997,10564.549179999998,]
exp_rand_99th_sem=[ 0.7572794490635704,1.2506449649601064,0.5587616307371791,1.3998795859272348,0.8067650617250062,1.465280735076063,0.8387900292052558,2.3418199063068688,2.9416735826896296,3.0327774233975338,3.807701155895682,5.001395130077393,8.81109035836126,11.39368699032069,13.13873942511082,14.460651081043547,61.52631989844455,]
exp_rand_99th9=[ 690.2358220000067,712.7452830000063,772.9082560000129,787.1254100000006,868.9056800000146,939.783056000037,978.4182030000128,1101.6120080000317,1180.952650000005,1334.4542200000024,1560.794440000035,1856.1158130000438,2319.2043190000672,2951.214065000009,4224.350909000417,7904.969000000212,12888.072105000103,]
exp_rand_99th9_sem=[ 10.411631054764767,12.452254211322911,8.844356799812644,14.93605407604442,8.000504511070774,12.114057426222098,5.457096116411612,21.5349553601088,13.40373206843197,77.0545363693741,36.44603027892421,23.028030493041946,57.65244801204227,75.0791710907508,75.95567231549245,33.88658930990111,50.60223926632532,]


#ax2.errorbar(exp_rate_tick,  exp_rand_50th, yerr=exp_rand_50th_sem, color="tab:red",linestyle='solid',
#    label="random 50th pct", marker='.', lw=1.5)
#ax2.errorbar(exp_rate_tick, exp_rand_95th, yerr=exp_rand_95th_sem, color="tab:red",linestyle='dashed',
#    label="random 95th pct", marker='.', lw=1.5)
ax3.errorbar(exp_rand_rate_tick, exp_rand_99th, yerr=exp_rand_99th_sem, color="tab:red",linestyle='solid',
    label="Random", marker='s', lw=1.5)
#ax2.errorbar(exp_rate_tick, exp_rand_99th9, yerr=exp_rand_99th9_sem, color="tab:red",linestyle='dotted',
#    label="random 99th9 pct", marker='.', lw=1.5)

#ax2.errorbar(exp_rate_tick, exp_select_50th, yerr=exp_select_50th_sem, color="tab:blue",linestyle='solid',
#    label="replica select 50th pct", marker='.', lw=1.5)
#ax2.errorbar(exp_rate_tick, exp_select_95th, yerr=exp_select_95th_sem, color="tab:blue",linestyle='dashed',
#    label="replica select 95th pct", marker='.', lw=1.5)
ax3.errorbar(exp_select_rate_tick, exp_select_99th, yerr=exp_select_99th_sem, color="tab:blue",linestyle='solid',
    label="Daronpon", marker='o', lw=1.5)
#ax2.errorbar(exp_rate_tick, exp_select_99th9, yerr=exp_select_99th9_sem, color="tab:blue",linestyle='dotted',
#    label="replica select 99th9 pct", marker='.', lw=1.5)

ax3.grid(True)
ax3.legend(loc='best', prop={'size': 12})
ax3.set_xlabel(fig_xlabel)
ax3.set_ylabel(fig_ylabel)
ax3.set_ylim(bottom=0, top=12000)
ax3.set_title("Exponential")




plt.tight_layout()
plt.savefig('hetero.pdf', format='pdf', dpi=500)
#plt.show()
